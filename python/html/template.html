{# template.html #}

<!DOCTYPE html>

<link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.4.0/css/all.css">

{# Force background-color to print, for use with print to pdf (used in headers) #}
<style>
  body{
    -webkit-print-color-adjust:exact !important;
    print-color-adjust:exact !important;
  }
</style>

<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Results</title>
</head>

<body>

{#  Structure:
    - Intro section with list of all requirements tested
    - Subsequent sections for each requirement tested
      - List of steps for each requirement
      - Screenshots for each step when relevant

    ... Are we basing these requirements off the 25 thu-mai provided, or the walkthrough she emailed
    ... ... I think we are doing the 25 provided, I'll break out the pieces of her workflow



#}

{# TODO: add RDMC logo when one exists #}
<h1>{{text.document_title}}</h1>
<p>{{text.document_description}}</p>

<hr>
<h2>Test Info</h2>
{# <p>Dataverse URL: {{info.dv_url}}</p>
<p>Dataverse Version: {{info.dv_version}}</p>
<p>Browser Version: {{info.browser_version}}</p>
<p>Test User: {{info.test_user}}</p> #}
<table>
<tr>
<td>Dataverse URL:</td>
<td>{{info.dv_url}}</td>
</tr>
<tr>
<td>Dataverse Version:&nbsp;&nbsp;&nbsp;</td>
<td>{{info.dv_version}}</td>
</tr>
<tr>
<td>Browser Version:</td>
<td>{{info.browser_version}}</td>
</tr>
<tr>
<td>Test User:</td>
<td>{{info.test_user}}</td>
</tr>
</table>

<hr>
<h2>Results</h2>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r01_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r02_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r03_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r04_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r05_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r06_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r09_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r10_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r11_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r12_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r13_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r15_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r16_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r17_title}}</p>
<p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{text.r20_title}}</p>

{# TODO: try iterating on the prefix for the text fields instead. We should be able to do this for the pictures as well#}
{# TODO: try adding page breaks at the end of each section for when we print to pdf. Start at https://stackoverflow.com/questions/42005819/ #}

{% for req in [1,2,3,4,5,6,9,10,11,12,13,15,16,17,20] %} {# range(1, 25) #}
  <br/>{# remove after page break? #}
  {# TODO: Round "PASS" text corners #}
  <div><h2 style="display:inline-block;">{{text['r' + ('%02d' % req) + '_title']}} </h2>&nbsp;&nbsp;<h4 style="position:relative; top: -6px; padding: 3px 3px 0px 3px; display:inline-block; background-color: #008e00;">PASS</h4></div>
  <hr>
  {% for key, value in text.items() %}
    {% if key.startswith('r' + ('%02d' % req) + '_p') %}
    <p><i class="fa-sharp fa-solid fa-circle-check" style="color: #008e00;"></i> {{value}}</p>
    <div style="margin-left: 7px;">
      {# We have to do make our count an object to deal with scoping issues in jinja #}
      {% set count = namespace(value=0) %}
      {# We first count how many screenshots #}
      {% for name in screenshots.keys() %}
        {% if name.startswith(key) %}
          {% set count.value = count.value + 1%}
        {% endif %}
      {% endfor %}
      {# Then we display each screenshot in a div #}
      {% for index in range(1, count.value + 1) %}
        <div style="display: inline-block; margin: 10px;">
          <img src="data:image/jpeg;base64,{{screenshots.get(key + '_s' + ('%02d' % index)) | safe}}" width="208" height="117" />
        </div>
      {% endfor %}
    </div>
    {% endif %}
  {% endfor %}
{% endfor %}

</body>
</html>
